{"version":3,"file":"template_preview.min.js","names":["window","document","onSocialMagickSampleClick","e","elTarget","currentTarget","sampleKey","dataset","samplekey","sampleOptions","Joomla","getOptions","getElementById","innerText","Text","_","toUpperCase","elCredits","setAttribute","source","credits","width","height","onSocialMagickRegenerateTemplatePreview","preventDefault","formData","FormData","forms","elImage","elBtn","src","classList","add","set","console","log","Object","fromEntries","response","fetch","method","body","ok","renderMessages","error","statusText","data","json","err","message","image","remove","slice","call","querySelectorAll","forEach","el","addEventListener"],"sources":["template_preview.js"],"sourcesContent":["/**\n * @package   socialmagick\n * @copyright Copyright (c)2025 Nicholas K. Dionysopoulos / Akeeba Ltd\n * @license   GNU General Public License version 3, or later\n */\n\n((window, document) =>\n{\n    const onSocialMagickSampleClick = (e) =>\n    {\n        const elTarget      = e.currentTarget;\n        const sampleKey     = elTarget.dataset.samplekey;\n        const sampleOptions = Joomla.getOptions(\"socialmagick_preview_samples\");\n\n        document.getElementById(\"socialMagicSampleDescription\").innerText =\n            Joomla.Text._(\"COM_SOCIALMAGICK_TEMPLATE_LBL_SAMPLE_IMAGE_OPT_\" + sampleKey.toUpperCase());\n\n        const elCredits = document.getElementById(\"socialMagicSampleCredits\");\n        elCredits.setAttribute(\"href\", sampleOptions[sampleKey].source);\n        elCredits.innerText = sampleOptions[sampleKey].credits;\n\n        document.getElementById(\"socialMagicSampleWidth\").innerText  = sampleOptions[sampleKey].width;\n        document.getElementById(\"socialMagicSampleHeight\").innerText = sampleOptions[sampleKey].height;\n    };\n\n    const onSocialMagickRegenerateTemplatePreview = async (e) =>\n    {\n        e.preventDefault();\n\n        const formData = new FormData(document.forms[\"adminForm\"]);\n        const elImage = document.getElementById(\"socialmagic_preview_img\");\n        const elBtn = document.getElementById(\"socialmagic_preview_link\");\n\n        elImage.src = '../media/com_socialmagick/images/loading.svg';\n        elBtn.setAttribute(\"href\", '#');\n        elBtn.classList.add('disabled');\n\n        formData.set('task', 'regeneratePreview');\n\n        console.log(Object.fromEntries(formData));\n\n        const response = await fetch(\n            \"index.php?option=com_socialmagick&view=templates&task=regeneratePreview&format=json\",\n            {\n                method: \"POST\",\n                body:   formData,\n            }\n        )\n\n        if (!response.ok)\n        {\n            Joomla.renderMessages({\n                error: [Joomla.Text._(\"COM_SOCIALMAGICK_TEMPLATE_ERR_REGEN_NETWORK\") + response.statusText]\n            })\n        }\n\n        var data = {};\n\n        try\n        {\n            data = await response.json();\n        }\n        catch (err)\n        {\n            data = {};\n\n            Joomla.renderMessages({\n                error: [err.message]\n            })\n        }\n\n        if (data?.image)\n        {\n            elImage.src = data.image;\n            elBtn.setAttribute(\"href\", data.image);\n            elBtn.classList.remove('disabled');\n        }\n        else\n        {\n            elImage.src = '../media/com_socialmagick/images/nope.svg';\n        }\n    };\n\n    // Initialisation\n    [].slice.call(document.querySelectorAll(\".socialMagickPreviewSample\")).forEach((el) =>\n    {\n        el.addEventListener(\"click\", onSocialMagickSampleClick);\n    });\n\n    document.getElementById('socialmagic_preview_refresh')?.addEventListener('click', onSocialMagickRegenerateTemplatePreview);\n})(window, document);\n"],"mappings":"AAAA;AACA;AACA;AACA;AACA;;AAEA,CAAC,CAACA,MAAM,EAAEC,QAAQ,KAClB;EACI,MAAMC,yBAAyB,GAAIC,CAAC,IACpC;IACI,MAAMC,QAAQ,GAAQD,CAAC,CAACE,aAAa;IACrC,MAAMC,SAAS,GAAOF,QAAQ,CAACG,OAAO,CAACC,SAAS;IAChD,MAAMC,aAAa,GAAGC,MAAM,CAACC,UAAU,CAAC,8BAA8B,CAAC;IAEvEV,QAAQ,CAACW,cAAc,CAAC,8BAA8B,CAAC,CAACC,SAAS,GAC7DH,MAAM,CAACI,IAAI,CAACC,CAAC,CAAC,iDAAiD,GAAGT,SAAS,CAACU,WAAW,CAAC,CAAC,CAAC;IAE9F,MAAMC,SAAS,GAAGhB,QAAQ,CAACW,cAAc,CAAC,0BAA0B,CAAC;IACrEK,SAAS,CAACC,YAAY,CAAC,MAAM,EAAET,aAAa,CAACH,SAAS,CAAC,CAACa,MAAM,CAAC;IAC/DF,SAAS,CAACJ,SAAS,GAAGJ,aAAa,CAACH,SAAS,CAAC,CAACc,OAAO;IAEtDnB,QAAQ,CAACW,cAAc,CAAC,wBAAwB,CAAC,CAACC,SAAS,GAAIJ,aAAa,CAACH,SAAS,CAAC,CAACe,KAAK;IAC7FpB,QAAQ,CAACW,cAAc,CAAC,yBAAyB,CAAC,CAACC,SAAS,GAAGJ,aAAa,CAACH,SAAS,CAAC,CAACgB,MAAM;EAClG,CAAC;EAED,MAAMC,uCAAuC,GAAG,MAAOpB,CAAC,IACxD;IACIA,CAAC,CAACqB,cAAc,CAAC,CAAC;IAElB,MAAMC,QAAQ,GAAG,IAAIC,QAAQ,CAACzB,QAAQ,CAAC0B,KAAK,CAAC,WAAW,CAAC,CAAC;IAC1D,MAAMC,OAAO,GAAG3B,QAAQ,CAACW,cAAc,CAAC,yBAAyB,CAAC;IAClE,MAAMiB,KAAK,GAAG5B,QAAQ,CAACW,cAAc,CAAC,0BAA0B,CAAC;IAEjEgB,OAAO,CAACE,GAAG,GAAG,8CAA8C;IAC5DD,KAAK,CAACX,YAAY,CAAC,MAAM,EAAE,GAAG,CAAC;IAC/BW,KAAK,CAACE,SAAS,CAACC,GAAG,CAAC,UAAU,CAAC;IAE/BP,QAAQ,CAACQ,GAAG,CAAC,MAAM,EAAE,mBAAmB,CAAC;IAEzCC,OAAO,CAACC,GAAG,CAACC,MAAM,CAACC,WAAW,CAACZ,QAAQ,CAAC,CAAC;IAEzC,MAAMa,QAAQ,GAAG,MAAMC,KAAK,CACxB,qFAAqF,EACrF;MACIC,MAAM,EAAE,MAAM;MACdC,IAAI,EAAIhB;IACZ,CACJ,CAAC;IAED,IAAI,CAACa,QAAQ,CAACI,EAAE,EAChB;MACIhC,MAAM,CAACiC,cAAc,CAAC;QAClBC,KAAK,EAAE,CAAClC,MAAM,CAACI,IAAI,CAACC,CAAC,CAAC,6CAA6C,CAAC,GAAGuB,QAAQ,CAACO,UAAU;MAC9F,CAAC,CAAC;IACN;IAEA,IAAIC,IAAI,GAAG,CAAC,CAAC;IAEb,IACA;MACIA,IAAI,GAAG,MAAMR,QAAQ,CAACS,IAAI,CAAC,CAAC;IAChC,CAAC,CACD,OAAOC,GAAG,EACV;MACIF,IAAI,GAAG,CAAC,CAAC;MAETpC,MAAM,CAACiC,cAAc,CAAC;QAClBC,KAAK,EAAE,CAACI,GAAG,CAACC,OAAO;MACvB,CAAC,CAAC;IACN;IAEA,IAAIH,IAAI,EAAEI,KAAK,EACf;MACItB,OAAO,CAACE,GAAG,GAAGgB,IAAI,CAACI,KAAK;MACxBrB,KAAK,CAACX,YAAY,CAAC,MAAM,EAAE4B,IAAI,CAACI,KAAK,CAAC;MACtCrB,KAAK,CAACE,SAAS,CAACoB,MAAM,CAAC,UAAU,CAAC;IACtC,CAAC,MAED;MACIvB,OAAO,CAACE,GAAG,GAAG,2CAA2C;IAC7D;EACJ,CAAC;;EAED;EACA,EAAE,CAACsB,KAAK,CAACC,IAAI,CAACpD,QAAQ,CAACqD,gBAAgB,CAAC,4BAA4B,CAAC,CAAC,CAACC,OAAO,CAAEC,EAAE,IAClF;IACIA,EAAE,CAACC,gBAAgB,CAAC,OAAO,EAAEvD,yBAAyB,CAAC;EAC3D,CAAC,CAAC;EAEFD,QAAQ,CAACW,cAAc,CAAC,6BAA6B,CAAC,EAAE6C,gBAAgB,CAAC,OAAO,EAAElC,uCAAuC,CAAC;AAC9H,CAAC,EAAEvB,MAAM,EAAEC,QAAQ,CAAC","ignoreList":[]}