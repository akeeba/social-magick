{"version":3,"file":"templates.min.js","names":["window","document","UNITS","UNIT_SIZE","formatDecimals","num","decimals","Number","Math","round","bytesToString","bytes","exp","min","floor","log","length","size","pow","unit","addEventListener","elContainer","getElementById","elSize","classList","add","token","Joomla","getOptions","formData","FormData","set","response","fetch","method","body","ok","renderMessages","error","Text","_","statusText","data","json","err","remove","innerText","total"],"sources":["templates.js"],"sourcesContent":["/**\n * @package   socialmagick\n * @copyright Copyright (c)2025 Nicholas K. Dionysopoulos / Akeeba Ltd\n * @license   GNU General Public License version 3, or later\n */\n\n((window, document) => {\n    const UNITS = [\"B\", \"KiB\", \"MiB\", \"GiB\", \"TiB\", \"PiB\", \"EiB\", \"ZiB\", \"YiB\"];\n    const UNIT_SIZE = 1024;\n\n    const formatDecimals = (num, decimals = 2) =>\n    {\n        return Number(Math.round(num + \"e\" + decimals) + \"e-\" + decimals);\n    };\n\n    const bytesToString = (bytes) =>\n    {\n        if (bytes === 0)\n        {\n            return \"0 B\";\n        }\n\n        const exp = Math.min(Math.floor(Math.log(bytes) / Math.log(UNIT_SIZE)), UNITS.length - 1);\n        const size = bytes / Math.pow(UNIT_SIZE, exp);\n        const unit = UNITS[exp];\n\n        return `${formatDecimals(size)} ${unit}`;\n    };\n\n    document.addEventListener(\"DOMContentLoaded\", async () =>\n    {\n        const elContainer = document.getElementById(\"socialMagickTotalImageSizeNotice\");\n        const elSize = document.getElementById(\"socialMagickTotalImageSize\");\n\n        elContainer?.classList?.add(\"d-none\");\n\n        const token = Joomla.getOptions(\"csrf.token\",\"\");\n        const formData = new FormData();\n\n        if (token)\n        {\n            formData.set(token, 1);\n        }\n\n        const response = await fetch(\n            \"index.php?option=com_socialmagick&view=templates&task=imagestotalsize&format=json\",\n            {\n                method: \"POST\",\n                body:   formData,\n            }\n        )\n\n        if (!response.ok)\n        {\n            Joomla.renderMessages({\n                error: [Joomla.Text._(\"COM_SOCIALMAGICK_TEMPLATE_ERR_IMAGESIZE_NETWORK\") + response.statusText]\n            })\n        }\n\n        var data = {};\n\n        try\n        {\n            data = await response.json();\n        }\n        catch (err)\n        {\n            data = {};\n\n            Joomla.renderMessages({\n                error: [Joomla.Text._(\"COM_SOCIALMAGICK_TEMPLATE_ERR_IMAGESIZE_JSON\") + response.statusText]\n            })\n        }\n\n        // TODO data.total\n        elContainer?.classList?.remove(\"d-none\");\n\n        if (elSize)\n        {\n            elSize.innerText = bytesToString(data?.total ?? 0);\n        }\n    })\n\n\n})(window, document);"],"mappings":"AAAA;AACA;AACA;AACA;AACA;;AAEA,CAAC,CAACA,MAAM,EAAEC,QAAQ,KAAK;EACnB,MAAMC,KAAK,GAAG,CAAC,GAAG,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,CAAC;EAC3E,MAAMC,SAAS,GAAG,IAAI;EAEtB,MAAMC,cAAc,GAAGA,CAACC,GAAG,EAAEC,QAAQ,GAAG,CAAC,KACzC;IACI,OAAOC,MAAM,CAACC,IAAI,CAACC,KAAK,CAACJ,GAAG,GAAG,GAAG,GAAGC,QAAQ,CAAC,GAAG,IAAI,GAAGA,QAAQ,CAAC;EACrE,CAAC;EAED,MAAMI,aAAa,GAAIC,KAAK,IAC5B;IACI,IAAIA,KAAK,KAAK,CAAC,EACf;MACI,OAAO,KAAK;IAChB;IAEA,MAAMC,GAAG,GAAGJ,IAAI,CAACK,GAAG,CAACL,IAAI,CAACM,KAAK,CAACN,IAAI,CAACO,GAAG,CAACJ,KAAK,CAAC,GAAGH,IAAI,CAACO,GAAG,CAACZ,SAAS,CAAC,CAAC,EAAED,KAAK,CAACc,MAAM,GAAG,CAAC,CAAC;IACzF,MAAMC,IAAI,GAAGN,KAAK,GAAGH,IAAI,CAACU,GAAG,CAACf,SAAS,EAAES,GAAG,CAAC;IAC7C,MAAMO,IAAI,GAAGjB,KAAK,CAACU,GAAG,CAAC;IAEvB,OAAO,GAAGR,cAAc,CAACa,IAAI,CAAC,IAAIE,IAAI,EAAE;EAC5C,CAAC;EAEDlB,QAAQ,CAACmB,gBAAgB,CAAC,kBAAkB,EAAE,YAC9C;IACI,MAAMC,WAAW,GAAGpB,QAAQ,CAACqB,cAAc,CAAC,kCAAkC,CAAC;IAC/E,MAAMC,MAAM,GAAGtB,QAAQ,CAACqB,cAAc,CAAC,4BAA4B,CAAC;IAEpED,WAAW,EAAEG,SAAS,EAAEC,GAAG,CAAC,QAAQ,CAAC;IAErC,MAAMC,KAAK,GAAGC,MAAM,CAACC,UAAU,CAAC,YAAY,EAAC,EAAE,CAAC;IAChD,MAAMC,QAAQ,GAAG,IAAIC,QAAQ,CAAC,CAAC;IAE/B,IAAIJ,KAAK,EACT;MACIG,QAAQ,CAACE,GAAG,CAACL,KAAK,EAAE,CAAC,CAAC;IAC1B;IAEA,MAAMM,QAAQ,GAAG,MAAMC,KAAK,CACxB,mFAAmF,EACnF;MACIC,MAAM,EAAE,MAAM;MACdC,IAAI,EAAIN;IACZ,CACJ,CAAC;IAED,IAAI,CAACG,QAAQ,CAACI,EAAE,EAChB;MACIT,MAAM,CAACU,cAAc,CAAC;QAClBC,KAAK,EAAE,CAACX,MAAM,CAACY,IAAI,CAACC,CAAC,CAAC,iDAAiD,CAAC,GAAGR,QAAQ,CAACS,UAAU;MAClG,CAAC,CAAC;IACN;IAEA,IAAIC,IAAI,GAAG,CAAC,CAAC;IAEb,IACA;MACIA,IAAI,GAAG,MAAMV,QAAQ,CAACW,IAAI,CAAC,CAAC;IAChC,CAAC,CACD,OAAOC,GAAG,EACV;MACIF,IAAI,GAAG,CAAC,CAAC;MAETf,MAAM,CAACU,cAAc,CAAC;QAClBC,KAAK,EAAE,CAACX,MAAM,CAACY,IAAI,CAACC,CAAC,CAAC,8CAA8C,CAAC,GAAGR,QAAQ,CAACS,UAAU;MAC/F,CAAC,CAAC;IACN;;IAEA;IACApB,WAAW,EAAEG,SAAS,EAAEqB,MAAM,CAAC,QAAQ,CAAC;IAExC,IAAItB,MAAM,EACV;MACIA,MAAM,CAACuB,SAAS,GAAGpC,aAAa,CAACgC,IAAI,EAAEK,KAAK,IAAI,CAAC,CAAC;IACtD;EACJ,CAAC,CAAC;AAGN,CAAC,EAAE/C,MAAM,EAAEC,QAAQ,CAAC","ignoreList":[]}